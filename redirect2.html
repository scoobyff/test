<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Player - Scooby</title>
  <script src="https://content.jwplatform.com/libraries/IDzF9Zmk.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/disable-devtool@latest"></script>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    html, body {
      font-family: 'Helvetica Neue', Arial, sans-serif;
      background-color: #000;
      overflow: hidden;
      width: 100%;
      height: 100%;
    }

    #myElement {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .jwplayer {
      position: absolute !important;
    }

    .jwplayer.jw-flag-aspect-mode {
      min-height: 100%;
      max-height: 100%;
    }

    /* Custom JWPlayer Logo Size */
    .jw-logo {
      width: 60px !important;
      height: 60px !important;
    }

    /* Error Message Style */
    #error-message {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      color: white;
      font-size: 22px;
      text-align: center;
      padding: 20px;
      background-color: rgba(0, 0, 0, 0.8);
      border-radius: 8px;
      z-index: 1000;
    }

    @media (max-width: 768px) {
      #error-message {
        font-size: 18px;
        padding: 15px;
        width: 90%;
      }
    }
  </style>
</head>
<body>
  <div id="myElement"></div>
  <div id="error-message"></div>

  <script>
    // Show custom error message
    function showError(message) {
      const errorDiv = document.getElementById('error-message');
      errorDiv.textContent = message;
      errorDiv.style.display = 'block';
    }

    // Get ?name= parameter
    function getUrlParameter(name) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(name);
    }

    const channelName = getUrlParameter('name');
    const directUrl = getUrlParameter('url');

    if (directUrl) {
      // Direct URL mode - use the URL directly
      const player = jwplayer("myElement");
      const setupOptions = {
        width: "100%",
        height: "100%",
        autostart: true,
        mute: false,
        primary: "html5",
        hlshtml: true,
        aspectratio: "16:9",
        stretching: "uniform",
        playbackRateControls: true,
        controls: true,
        floating: false,
        preload: "auto",
        responsive: true,
        logo: {
          file: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/Superman_shield.svg/640px-Superman_shield.svg.png",
          link: "",
          position: "top-left",
          margin: 7,
          hide: true
        },
        file: directUrl
      };

      player.setup(setupOptions);
    } else if (!channelName) {
      showError('No channel name or URL specified!');
    } else {
      fetch('api.json')
        .then(response => response.json())
        .then(data => {
          // Find channel by name (case-insensitive)
          const channel = data.find(item => 
            item.name.toLowerCase() === channelName.toLowerCase()
          );

          if (!channel || !channel.url) {
            showError('Channel not found or no URL available!');
            return;
          }

          // JWPlayer Setup
          const player = jwplayer("myElement");
          const setupOptions = {
            width: "100%",
            height: "100%",
            autostart: true,
            mute: false,
            primary: "html5",
            hlshtml: true,
            aspectratio: "16:9",
            stretching: "uniform",
            playbackRateControls: true,
            controls: true,
            floating: false,
            preload: "auto",
            responsive: true,
            logo: {
              file: "https://upload.wikimedia.org/wikipedia/commons/thumb/e/ea/Superman_shield.svg/640px-Superman_shield.svg.png",
              link: "",
              position: "top-left",
              margin: 7,
              hide: true
            }
          };

          // Handle different stream types
          if (channel.type === "clearkey") {
            setupOptions.file = channel.url;
            setupOptions.drm = {
              clearkey: {
                keyId: channel.k1,
                key: channel.k2
              }
            };
          } else if (channel.type === "hls") {
            setupOptions.file = channel.url;
          } else {
            showError("Unsupported stream type!");
            return;
          }

          player.setup(setupOptions);
        })
        .catch(err => {
          console.error(err);
          showError('Error loading channel data.');
        });
    }
  </script>
</body>
</html>