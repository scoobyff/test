<!DOCTYPE html>
<html>
<head>
  <title>KeyID:Key Decoder</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    input, textarea { width: 100%; padding: 10px; margin-top: 10px; }
    button { padding: 10px 15px; margin-top: 10px; }
    pre { background: #f0f0f0; padding: 10px; }
  </style>
</head>
<body>
  <h2>KeyID:Key Decoder</h2>
  <textarea id="input" rows="6" placeholder='Paste your full message here...'></textarea>
  <button onclick="decode()">Decode</button>
  <button onclick="copyOutput()">Copy</button>

  <h3>Output:</h3>
  <pre id="output"></pre>

  <script>
    function base64urlToHex(b64url) {
      let b64 = b64url.replace(/-/g, '+').replace(/_/g, '/');
      while (b64.length % 4) b64 += '=';
      let binary = atob(b64);
      let hex = '';
      for (let i = 0; i < binary.length; i++) {
        hex += ('0' + binary.charCodeAt(i).toString(16)).slice(-2);
      }
      return hex;
    }

    function decode() {
      const input = document.getElementById('input').value;
      const kMatch = input.match(/"k"\s*:\s*"([^"]+)"/);
      const kidMatch = input.match(/"kid"\s*:\s*"([^"]+)"/);

      if (!kMatch || !kidMatch) {
        document.getElementById('output').textContent = 'Error: Could not find both "k" and "kid" in the input.';
        return;
      }

      const kHex = base64urlToHex(kMatch[1]);
      const kidHex = base64urlToHex(kidMatch[1]);

      document.getElementById('output').textContent = `${kidHex}:${kHex}`;
    }

    function copyOutput() {
      const output = document.getElementById('output').textContent;
      navigator.clipboard.writeText(output).then(() => {
        alert('Copied to clipboard!');
      });
    }
  </script>
</body>
</html>
